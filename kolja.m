%% Import RCP data 
fid = fopen('ch4.txt');
ch4data = fscanf(fid, '%f', [736 4]);

CH426data = ch4data(:,1);
CH445data = ch4data(:,2);
CH460data = ch4data(:,3);
CH485data = ch4data(:,4);

CO285data = [2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.89E+02	2.89E+02	2.89E+02	2.90E+02	2.90E+02	2.91E+02	2.91E+02	2.92E+02	2.92E+02	2.93E+02	2.93E+02	2.93E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.96E+02	2.96E+02	2.96E+02	2.96E+02	2.97E+02	2.97E+02	2.98E+02	2.98E+02	2.99E+02	2.99E+02	2.99E+02	3.00E+02	3.00E+02	3.00E+02	3.01E+02	3.01E+02	3.01E+02	3.02E+02	3.02E+02	3.02E+02	3.03E+02	3.03E+02	3.03E+02	3.04E+02	3.04E+02	3.05E+02	3.05E+02	3.05E+02	3.06E+02	3.06E+02	3.07E+02	3.07E+02	3.08E+02	3.08E+02	3.09E+02	3.09E+02	3.09E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.11E+02	3.11E+02	3.11E+02	3.12E+02	3.12E+02	3.12E+02	3.13E+02	3.14E+02	3.14E+02	3.15E+02	3.16E+02	3.16E+02	3.17E+02	3.18E+02	3.18E+02	3.19E+02	3.20E+02	3.21E+02	3.22E+02	3.23E+02	3.24E+02	3.25E+02	3.26E+02	3.27E+02	3.29E+02	3.30E+02	3.31E+02	3.32E+02	3.33E+02	3.35E+02	3.37E+02	3.38E+02	3.40E+02	3.41E+02	3.42E+02	3.44E+02	3.45E+02	3.47E+02	3.49E+02	3.51E+02	3.52E+02	3.54E+02	3.55E+02	3.56E+02	3.57E+02	3.58E+02	3.60E+02	3.61E+02	3.63E+02	3.65E+02	3.67E+02	3.69E+02	3.70E+02	3.73E+02	3.75E+02	3.77E+02	3.79E+02	3.81E+02	3.83E+02	3.85E+02	3.87E+02	3.89E+02	3.92E+02	3.94E+02	3.96E+02	3.99E+02	4.02E+02	4.04E+02	4.07E+02	4.10E+02	4.13E+02	4.16E+02	4.19E+02	4.22E+02	4.25E+02	4.28E+02	4.31E+02	4.35E+02	4.38E+02	4.42E+02	4.45E+02	4.49E+02	4.52E+02	4.56E+02	4.60E+02	4.64E+02	4.68E+02	4.72E+02	4.76E+02	4.81E+02	4.85E+02	4.89E+02	4.94E+02	4.99E+02	5.04E+02	5.08E+02	5.13E+02	5.19E+02	5.24E+02	5.29E+02	5.35E+02	5.41E+02	5.46E+02	5.52E+02	5.58E+02	5.64E+02	5.71E+02	5.77E+02	5.83E+02	5.90E+02	5.97E+02	6.04E+02	6.11E+02	6.18E+02	6.25E+02	6.32E+02	6.39E+02	6.47E+02	6.54E+02	6.62E+02	6.69E+02	6.77E+02	6.85E+02	6.93E+02	7.01E+02	7.09E+02	7.17E+02	7.25E+02	7.33E+02	7.42E+02	7.50E+02	7.58E+02	7.67E+02	7.75E+02	7.84E+02	7.92E+02	8.01E+02	8.10E+02	8.18E+02	8.27E+02	8.36E+02	8.45E+02	8.54E+02	8.63E+02	8.72E+02	8.81E+02	8.90E+02	8.99E+02	9.08E+02	9.17E+02	9.27E+02	9.36E+02	9.45E+02	9.54E+02	9.64E+02	9.73E+02	9.83E+02	9.92E+02	1.00E+03	1.01E+03	1.02E+03	1.03E+03	1.04E+03	1.05E+03	1.06E+03	1.07E+03	1.08E+03	1.09E+03	1.10E+03	1.11E+03	1.12E+03	1.13E+03	1.14E+03	1.15E+03	1.16E+03	1.17E+03	1.18E+03	1.19E+03	1.20E+03	1.21E+03	1.22E+03	1.23E+03	1.24E+03	1.25E+03	1.26E+03	1.27E+03	1.28E+03	1.29E+03	1.30E+03	1.31E+03	1.32E+03	1.33E+03	1.34E+03	1.35E+03	1.36E+03	1.37E+03	1.38E+03	1.39E+03	1.40E+03	1.41E+03	1.42E+03	1.43E+03	1.44E+03	1.45E+03	1.46E+03	1.47E+03	1.48E+03	1.49E+03	1.50E+03	1.51E+03	1.52E+03	1.53E+03	1.54E+03	1.55E+03	1.56E+03	1.57E+03	1.58E+03	1.58E+03	1.59E+03	1.60E+03	1.61E+03	1.62E+03	1.63E+03	1.64E+03	1.64E+03	1.65E+03	1.66E+03	1.67E+03	1.68E+03	1.68E+03	1.69E+03	1.70E+03	1.71E+03	1.71E+03	1.72E+03	1.73E+03	1.74E+03	1.74E+03	1.75E+03	1.76E+03	1.76E+03	1.77E+03	1.78E+03	1.78E+03	1.79E+03	1.79E+03	1.80E+03	1.81E+03	1.81E+03	1.82E+03	1.82E+03	1.83E+03	1.83E+03	1.84E+03	1.84E+03	1.85E+03	1.85E+03	1.86E+03	1.86E+03	1.87E+03	1.87E+03	1.88E+03	1.88E+03	1.89E+03	1.89E+03	1.89E+03	1.90E+03	1.90E+03	1.91E+03	1.91E+03	1.91E+03	1.92E+03	1.92E+03	1.92E+03	1.92E+03	1.93E+03	1.93E+03	1.93E+03	1.94E+03	1.94E+03	1.94E+03	1.94E+03	1.94E+03	1.95E+03	1.95E+03	1.95E+03	1.95E+03	1.95E+03	1.95E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03	1.96E+03];
CO260data = [2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.89E+02	2.89E+02	2.89E+02	2.90E+02	2.90E+02	2.91E+02	2.91E+02	2.92E+02	2.92E+02	2.93E+02	2.93E+02	2.93E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.96E+02	2.96E+02	2.96E+02	2.96E+02	2.97E+02	2.97E+02	2.98E+02	2.98E+02	2.99E+02	2.99E+02	2.99E+02	3.00E+02	3.00E+02	3.00E+02	3.01E+02	3.01E+02	3.01E+02	3.02E+02	3.02E+02	3.02E+02	3.03E+02	3.03E+02	3.03E+02	3.04E+02	3.04E+02	3.05E+02	3.05E+02	3.05E+02	3.06E+02	3.06E+02	3.07E+02	3.07E+02	3.08E+02	3.08E+02	3.09E+02	3.09E+02	3.09E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.11E+02	3.11E+02	3.11E+02	3.12E+02	3.12E+02	3.12E+02	3.13E+02	3.14E+02	3.14E+02	3.15E+02	3.16E+02	3.16E+02	3.17E+02	3.18E+02	3.18E+02	3.19E+02	3.20E+02	3.21E+02	3.22E+02	3.23E+02	3.24E+02	3.25E+02	3.26E+02	3.27E+02	3.29E+02	3.30E+02	3.31E+02	3.32E+02	3.33E+02	3.35E+02	3.37E+02	3.38E+02	3.40E+02	3.41E+02	3.42E+02	3.44E+02	3.45E+02	3.47E+02	3.49E+02	3.51E+02	3.52E+02	3.54E+02	3.55E+02	3.56E+02	3.57E+02	3.58E+02	3.60E+02	3.61E+02	3.63E+02	3.65E+02	3.67E+02	3.69E+02	3.70E+02	3.73E+02	3.75E+02	3.77E+02	3.79E+02	3.81E+02	3.83E+02	3.85E+02	3.87E+02	3.89E+02	3.91E+02	3.93E+02	3.95E+02	3.97E+02	3.99E+02	4.01E+02	4.03E+02	4.05E+02	4.07E+02	4.09E+02	4.11E+02	4.13E+02	4.15E+02	4.17E+02	4.19E+02	4.21E+02	4.23E+02	4.25E+02	4.27E+02	4.29E+02	4.31E+02	4.33E+02	4.35E+02	4.37E+02	4.39E+02	4.41E+02	4.44E+02	4.46E+02	4.48E+02	4.51E+02	4.53E+02	4.56E+02	4.58E+02	4.61E+02	4.63E+02	4.66E+02	4.69E+02	4.72E+02	4.75E+02	4.78E+02	4.81E+02	4.84E+02	4.87E+02	4.90E+02	4.93E+02	4.97E+02	5.00E+02	5.03E+02	5.07E+02	5.11E+02	5.14E+02	5.18E+02	5.22E+02	5.26E+02	5.29E+02	5.33E+02	5.37E+02	5.41E+02	5.46E+02	5.50E+02	5.54E+02	5.58E+02	5.63E+02	5.67E+02	5.72E+02	5.76E+02	5.81E+02	5.85E+02	5.90E+02	5.94E+02	5.99E+02	6.04E+02	6.08E+02	6.12E+02	6.17E+02	6.21E+02	6.25E+02	6.28E+02	6.32E+02	6.36E+02	6.39E+02	6.43E+02	6.46E+02	6.50E+02	6.53E+02	6.56E+02	6.60E+02	6.63E+02	6.66E+02	6.70E+02	6.73E+02	6.76E+02	6.80E+02	6.83E+02	6.86E+02	6.89E+02	6.92E+02	6.94E+02	6.97E+02	7.00E+02	7.02E+02	7.05E+02	7.07E+02	7.10E+02	7.12E+02	7.14E+02	7.16E+02	7.19E+02	7.21E+02	7.23E+02	7.24E+02	7.26E+02	7.28E+02	7.30E+02	7.31E+02	7.33E+02	7.34E+02	7.36E+02	7.37E+02	7.39E+02	7.40E+02	7.41E+02	7.42E+02	7.43E+02	7.44E+02	7.45E+02	7.46E+02	7.47E+02	7.48E+02	7.48E+02	7.49E+02	7.50E+02	7.50E+02	7.51E+02	7.51E+02	7.51E+02	7.51E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02	7.52E+02];
CO245data = [2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.89E+02	2.89E+02	2.89E+02	2.90E+02	2.90E+02	2.91E+02	2.91E+02	2.92E+02	2.92E+02	2.93E+02	2.93E+02	2.93E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.96E+02	2.96E+02	2.96E+02	2.96E+02	2.97E+02	2.97E+02	2.98E+02	2.98E+02	2.99E+02	2.99E+02	2.99E+02	3.00E+02	3.00E+02	3.00E+02	3.01E+02	3.01E+02	3.01E+02	3.02E+02	3.02E+02	3.02E+02	3.03E+02	3.03E+02	3.03E+02	3.04E+02	3.04E+02	3.05E+02	3.05E+02	3.05E+02	3.06E+02	3.06E+02	3.07E+02	3.07E+02	3.08E+02	3.08E+02	3.09E+02	3.09E+02	3.09E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.11E+02	3.11E+02	3.11E+02	3.12E+02	3.12E+02	3.12E+02	3.13E+02	3.14E+02	3.14E+02	3.15E+02	3.16E+02	3.16E+02	3.17E+02	3.18E+02	3.18E+02	3.19E+02	3.20E+02	3.21E+02	3.22E+02	3.23E+02	3.24E+02	3.25E+02	3.26E+02	3.27E+02	3.29E+02	3.30E+02	3.31E+02	3.32E+02	3.33E+02	3.35E+02	3.37E+02	3.38E+02	3.40E+02	3.41E+02	3.42E+02	3.44E+02	3.45E+02	3.47E+02	3.49E+02	3.51E+02	3.52E+02	3.54E+02	3.55E+02	3.56E+02	3.57E+02	3.58E+02	3.60E+02	3.61E+02	3.63E+02	3.65E+02	3.67E+02	3.69E+02	3.70E+02	3.73E+02	3.75E+02	3.77E+02	3.79E+02	3.81E+02	3.83E+02	3.85E+02	3.87E+02	3.89E+02	3.91E+02	3.93E+02	3.96E+02	3.98E+02	4.00E+02	4.02E+02	4.04E+02	4.07E+02	4.09E+02	4.11E+02	4.13E+02	4.16E+02	4.18E+02	4.20E+02	4.23E+02	4.25E+02	4.28E+02	4.30E+02	4.33E+02	4.35E+02	4.38E+02	4.40E+02	4.43E+02	4.45E+02	4.48E+02	4.50E+02	4.53E+02	4.56E+02	4.58E+02	4.61E+02	4.63E+02	4.66E+02	4.69E+02	4.71E+02	4.74E+02	4.76E+02	4.79E+02	4.81E+02	4.84E+02	4.87E+02	4.89E+02	4.92E+02	4.94E+02	4.96E+02	4.98E+02	5.01E+02	5.03E+02	5.05E+02	5.07E+02	5.09E+02	5.11E+02	5.13E+02	5.14E+02	5.16E+02	5.18E+02	5.19E+02	5.20E+02	5.22E+02	5.23E+02	5.24E+02	5.25E+02	5.27E+02	5.27E+02	5.28E+02	5.29E+02	5.30E+02	5.30E+02	5.31E+02	5.31E+02	5.31E+02	5.31E+02	5.31E+02	5.32E+02	5.32E+02	5.32E+02	5.32E+02	5.33E+02	5.33E+02	5.33E+02	5.34E+02	5.34E+02	5.35E+02	5.35E+02	5.35E+02	5.36E+02	5.36E+02	5.37E+02	5.37E+02	5.38E+02	5.38E+02	5.39E+02	5.39E+02	5.40E+02	5.40E+02	5.41E+02	5.41E+02	5.42E+02	5.42E+02	5.42E+02	5.42E+02	5.42E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02	5.43E+02];
CO226data = [2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.78E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.79E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.80E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.81E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.82E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.83E+02	2.83E+02	2.83E+02	2.83E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.84E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.85E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.86E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.87E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.88E+02	2.89E+02	2.89E+02	2.89E+02	2.90E+02	2.90E+02	2.91E+02	2.91E+02	2.92E+02	2.92E+02	2.93E+02	2.93E+02	2.93E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.94E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.95E+02	2.96E+02	2.96E+02	2.96E+02	2.96E+02	2.97E+02	2.97E+02	2.98E+02	2.98E+02	2.99E+02	2.99E+02	2.99E+02	3.00E+02	3.00E+02	3.00E+02	3.01E+02	3.01E+02	3.01E+02	3.02E+02	3.02E+02	3.02E+02	3.03E+02	3.03E+02	3.03E+02	3.04E+02	3.04E+02	3.05E+02	3.05E+02	3.05E+02	3.06E+02	3.06E+02	3.07E+02	3.07E+02	3.08E+02	3.08E+02	3.09E+02	3.09E+02	3.09E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.10E+02	3.11E+02	3.11E+02	3.11E+02	3.12E+02	3.12E+02	3.12E+02	3.13E+02	3.14E+02	3.14E+02	3.15E+02	3.16E+02	3.16E+02	3.17E+02	3.18E+02	3.18E+02	3.19E+02	3.20E+02	3.21E+02	3.22E+02	3.23E+02	3.24E+02	3.25E+02	3.26E+02	3.27E+02	3.29E+02	3.30E+02	3.31E+02	3.32E+02	3.33E+02	3.35E+02	3.37E+02	3.38E+02	3.40E+02	3.41E+02	3.42E+02	3.44E+02	3.45E+02	3.47E+02	3.49E+02	3.51E+02	3.52E+02	3.54E+02	3.55E+02	3.56E+02	3.57E+02	3.58E+02	3.60E+02	3.61E+02	3.63E+02	3.65E+02	3.67E+02	3.69E+02	3.70E+02	3.73E+02	3.75E+02	3.77E+02	3.79E+02	3.81E+02	3.83E+02	3.85E+02	3.87E+02	3.89E+02	3.92E+02	3.94E+02	3.96E+02	3.98E+02	4.01E+02	4.03E+02	4.05E+02	4.08E+02	4.10E+02	4.12E+02	4.14E+02	4.17E+02	4.19E+02	4.21E+02	4.23E+02	4.24E+02	4.26E+02	4.28E+02	4.29E+02	4.31E+02	4.32E+02	4.33E+02	4.35E+02	4.36E+02	4.37E+02	4.38E+02	4.38E+02	4.39E+02	4.40E+02	4.40E+02	4.41E+02	4.41E+02	4.41E+02	4.42E+02	4.42E+02	4.42E+02	4.42E+02	4.42E+02	4.43E+02	4.43E+02	4.43E+02	4.43E+02	4.43E+02	4.43E+02	4.43E+02	4.42E+02	4.42E+02	4.42E+02	4.42E+02	4.42E+02	4.41E+02	4.41E+02	4.41E+02	4.40E+02	4.40E+02	4.40E+02	4.39E+02	4.39E+02	4.38E+02	4.37E+02	4.37E+02	4.36E+02	4.36E+02	4.35E+02	4.35E+02	4.34E+02	4.33E+02	4.33E+02	4.32E+02	4.32E+02	4.31E+02	4.31E+02	4.30E+02	4.29E+02	4.29E+02	4.28E+02	4.28E+02	4.27E+02	4.27E+02	4.26E+02	4.25E+02	4.25E+02	4.24E+02	4.24E+02	4.23E+02	4.23E+02	4.22E+02	4.22E+02	4.21E+02	4.21E+02	4.20E+02	4.20E+02	4.19E+02	4.19E+02	4.19E+02	4.18E+02	4.18E+02	4.17E+02	4.17E+02	4.16E+02	4.16E+02	4.15E+02	4.15E+02	4.14E+02	4.14E+02	4.14E+02	4.13E+02	4.13E+02	4.12E+02	4.12E+02	4.11E+02	4.11E+02	4.10E+02	4.10E+02	4.09E+02	4.09E+02	4.08E+02	4.08E+02	4.08E+02	4.07E+02	4.07E+02	4.06E+02	4.06E+02	4.05E+02	4.05E+02	4.04E+02	4.04E+02	4.04E+02	4.03E+02	4.03E+02	4.03E+02	4.02E+02	4.02E+02	4.01E+02	4.01E+02	4.01E+02	4.00E+02	4.00E+02	3.99E+02	3.99E+02	3.99E+02	3.98E+02	3.98E+02	3.98E+02	3.97E+02	3.97E+02	3.97E+02	3.96E+02	3.96E+02	3.96E+02	3.95E+02	3.95E+02	3.95E+02	3.94E+02	3.94E+02	3.94E+02	3.93E+02	3.93E+02	3.93E+02	3.92E+02	3.92E+02	3.92E+02	3.92E+02	3.91E+02	3.91E+02	3.91E+02	3.90E+02	3.90E+02	3.90E+02	3.89E+02	3.89E+02	3.89E+02	3.89E+02	3.88E+02	3.88E+02	3.88E+02	3.87E+02	3.87E+02	3.87E+02	3.86E+02	3.86E+02	3.86E+02	3.86E+02	3.85E+02	3.85E+02	3.85E+02	3.85E+02	3.84E+02	3.84E+02	3.84E+02	3.83E+02	3.83E+02	3.83E+02	3.83E+02	3.82E+02	3.82E+02	3.82E+02	3.82E+02	3.81E+02	3.81E+02	3.81E+02	3.81E+02	3.80E+02	3.80E+02	3.80E+02	3.80E+02	3.79E+02	3.79E+02	3.79E+02	3.79E+02	3.78E+02	3.78E+02	3.78E+02	3.78E+02	3.77E+02	3.77E+02	3.77E+02	3.77E+02	3.76E+02	3.76E+02	3.76E+02	3.76E+02	3.75E+02	3.75E+02	3.75E+02	3.75E+02	3.74E+02	3.74E+02	3.74E+02	3.74E+02	3.74E+02	3.73E+02	3.73E+02	3.73E+02	3.73E+02	3.72E+02	3.72E+02	3.72E+02	3.72E+02	3.71E+02	3.71E+02	3.71E+02	3.71E+02	3.70E+02	3.70E+02	3.70E+02	3.70E+02	3.70E+02	3.69E+02	3.69E+02	3.69E+02	3.69E+02	3.69E+02	3.68E+02	3.68E+02	3.68E+02	3.68E+02	3.67E+02	3.67E+02	3.67E+02	3.67E+02	3.67E+02	3.66E+02	3.66E+02	3.66E+02	3.66E+02	3.65E+02	3.65E+02	3.65E+02	3.65E+02	3.65E+02	3.64E+02	3.64E+02	3.64E+02	3.64E+02	3.64E+02	3.63E+02	3.63E+02	3.63E+02	3.63E+02	3.63E+02	3.62E+02	3.62E+02	3.62E+02	3.62E+02	3.62E+02	3.61E+02	3.61E+02	3.61E+02	3.61E+02	3.60E+02	3.60E+02	3.60E+02	3.60E+02	3.60E+02	3.60E+02	3.59E+02	3.59E+02	3.59E+02	3.59E+02	3.58E+02	3.58E+02	3.58E+02	3.58E+02	3.58E+02	3.58E+02	3.57E+02	3.57E+02	3.57E+02	3.57E+02	3.57E+02	3.56E+02	3.56E+02	3.56E+02	3.56E+02	3.56E+02	3.55E+02	3.55E+02	3.55E+02	3.55E+02	3.55E+02	3.54E+02	3.54E+02	3.54E+02	3.54E+02	3.54E+02	3.54E+02	3.53E+02	3.53E+02	3.53E+02	3.53E+02	3.53E+02	3.52E+02	3.52E+02	3.52E+02	3.52E+02	3.52E+02	3.52E+02	3.51E+02	3.51E+02	3.51E+02	3.51E+02	3.51E+02	3.50E+02	3.50E+02	3.50E+02	3.50E+02	3.50E+02	3.50E+02	3.49E+02	3.49E+02	3.49E+02	3.49E+02	3.49E+02	3.48E+02	3.48E+02	3.48E+02	3.48E+02	3.48E+02	3.48E+02	3.47E+02	3.47E+02	3.47E+02	3.47E+02	3.47E+02	3.47E+02	3.46E+02	3.46E+02	3.46E+02	3.46E+02	3.46E+02	3.46E+02	3.45E+02	3.45E+02	3.45E+02	3.45E+02	3.45E+02	3.44E+02	3.44E+02	3.44E+02	3.44E+02	3.44E+02	3.44E+02	3.44E+02	3.43E+02	3.43E+02	3.43E+02	3.43E+02	3.43E+02	3.42E+02	3.42E+02	3.42E+02	3.42E+02	3.42E+02	3.42E+02	3.42E+02	3.41E+02	3.41E+02	3.41E+02	3.41E+02	3.41E+02	3.41E+02	3.40E+02	3.40E+02	3.40E+02	3.40E+02	3.40E+02	3.40E+02	3.39E+02	3.39E+02	3.39E+02	3.39E+02	3.39E+02	3.39E+02	3.38E+02	3.38E+02	3.38E+02	3.38E+02	3.38E+02	3.38E+02	3.37E+02	3.37E+02	3.37E+02	3.37E+02	3.37E+02	3.37E+02	3.37E+02	3.36E+02	3.36E+02	3.36E+02	3.36E+02	3.36E+02	3.36E+02	3.35E+02	3.35E+02	3.35E+02	3.35E+02	3.35E+02	3.35E+02	3.35E+02	3.34E+02	3.34E+02	3.34E+02	3.34E+02	3.34E+02	3.34E+02	3.33E+02	3.33E+02	3.33E+02	3.33E+02	3.33E+02	3.33E+02	3.33E+02	3.32E+02	3.32E+02	3.32E+02	3.32E+02	3.32E+02	3.32E+02	3.32E+02	3.31E+02	3.31E+02	3.31E+02	3.31E+02	3.31E+02	3.31E+02	3.30E+02	3.30E+02	3.30E+02	3.30E+02	3.30E+02	3.30E+02	3.30E+02	3.29E+02	3.29E+02	3.29E+02	3.29E+02	3.29E+02	3.29E+02	3.29E+02	3.28E+02	3.28E+02	3.28E+02	3.28E+02	3.28E+02	3.28E+02	3.28E+02	3.27E+02	3.27E+02	3.27E+02];

%reshaped cause I like to look at columns as opposed to rows 
CO226data = reshape(CO226data, [length(CO285data) 1]);
CO245data = reshape(CO245data, [length(CO285data) 1]);
CO260data = reshape(CO260data, [length(CO285data) 1]);
CO285data = reshape(CO285data, [length(CO285data) 1]);

%% Koenigk and Brodeau, Yang as well 
FOref = 10;
FAref = 104.03;

maxvalFO = @(y) (y - 2.6).*(19.5 - 13)./(8.5 - 2.6) + 13;
%maxvalFA = @(y) (y - 2.6).*(97.53 - 104.03)./(8.5 - 2.6) + 104.03;
maxvalFA = @(y) 129;

%gonna have to do this 4 times...
linFO26 = @(x) 9.75 + (x-1900).*(maxvalFO(2.6)-9.75)./(2100-1900);
linFA26 = @(x) 107.28 + (x-1900).*(maxvalFA(2.6)-107.28)./(2100-1900);

linFO45 = @(x) 9.75 + (x-1900).*(maxvalFO(4.5)-9.75)./(2100-1900);
linFA45 = @(x) 107.28 + (x-1900).*(maxvalFA(4.5)-107.28)./(2100-1900);

linFO60 = @(x) 9.75 + (x-1900).*(maxvalFO(6.0)-9.75)./(2100-1900);
linFA60 = @(x) 107.28 + (x-1900).*(maxvalFA(6.0)-107.28)./(2100-1900);

linFO85 = @(x) 9.75 + (x-1900).*(maxvalFO(8.5)-9.75)./(2100-1900);
linFA85 = @(x) 107.28 + (x-1900).*(maxvalFA(8.5)-107.28)./(2100-1900);

times = linspace(2000, 2500, 501);

%%
for i=1:(2100-1999)
    FO26(i) = linFO26(times(i));
    FA26(i) = linFA26(times(i));
    FO45(i) = linFO45(times(i));
    FA45(i) = linFA45(times(i));
    FO60(i) = linFO60(times(i));
    FA60(i) = linFA60(times(i));
    FO85(i) = linFO85(times(i));
    FA85(i) = linFA85(times(i));
end 

FO_arr26 = [FO26 maxvalFO(2.6).*ones([1 length(times)-length(FO26)])];
FA_arr26 = [FA26 maxvalFA(2.6).*ones([1 length(times)-length(FA26)])];
FO_arr45 = [FO45 maxvalFO(4.5).*ones([1 length(times)-length(FO26)])];
FA_arr45 = [FA45 maxvalFA(4.5).*ones([1 length(times)-length(FA26)])];

FO_arr60 = [FO60 maxvalFO(6.0).*ones([1 length(times)-length(FO26)])];
FA_arr60 = [FA60 maxvalFA(6.0).*ones([1 length(times)-length(FA26)])];

FO_arr85 = [FO85 maxvalFO(8.5).*ones([1 length(times)-length(FO26)])];
FA_arr85 = [FA85 maxvalFA(8.5).*ones([1 length(times)-length(FA26)])];
%% overwrite FA arrays to constant 
FA_arr26 = 104.03*ones([1 length(times)]);
FA_arr45 = 104.03*ones([1 length(times)]);
FA_arr60 = 104.03*ones([1 length(times)]);
FA_arr85 = 104.03*ones([1 length(times)]);
%% overwrite FO to constant 
FO_arr26 = 10*ones([1 length(times)]);
FO_arr45 = 10*ones([1 length(times)]);
FO_arr60 = 10*ones([1 length(times)]);
FO_arr85 = 10*ones([1 length(times)]);

%% Information provided by Langford, year 2000
R1 = 0.19.*10^12;  %kg a^-1
mu2 = 76.5;    %ppm

tau_ref = 0.8934;
mass_atm = 8.6454e+18;  %kg
fCO2 = 0.977;   %fraction of permafrost carbon released as CO2
fCH4 = 0.023;   %fraction of permafrost carbon released as CH4
MCO2 = 44.01.*10.^-3;  %kg mol^-1
MA = 28.97.*10.^-3;  %kg mol^-1
MCH4 = 16.04.*10^-3;    %kg mol^-1
k_CH4 = log(2)./9.1;    %decay rate of ch4

%define the dynamics for use in difference equations 
murate = @(tau) 10.^6.*(MA./MCO2).*(Q10(R1,tau_ref,tau,1.5).*fCO2)./mass_atm;
nurate = @(tau,nu2) 10.^9.*(MA./MCH4).*(Q10(R1,tau_ref,tau,1.5).*fCH4)./mass_atm - k_CH4.*nu2;

%we don't currently know how much permafrost CH4 is in atmosphere in year
%2000.  So I'll just set this value to zero for the time being 
nu2 = 0;
%% quickly generate bifurcation diagram w/ permafrost 

%RCP 2.5
%arrays for running ghg sums.  Last entry always denotes total sum of that gas
%released from permafrost.  Will have to clear these in between RCPs
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%variables to store RCP data
mu_1 = CO226data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH426data(236:end);

%compute first step so we can change x0 in solver dynamically
tau26(1) = equilibrium(FO_arr26(1), FA_arr26(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau26(end));
nu_2(end+1) = nu_2(end) + nurate(tau26(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau26(end+1) = equilibrium(FO_arr26(i), FA_arr26(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau26(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau26(end));
    nu_2(end+1) = nu_2(end) + nurate(tau26(end), nu_2(end));
end 

%clear sums and re-initialize 
clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 4.5
%variables to store RCP data
mu_1 = CO245data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH445data(236:end);

%initialize array for equilibrium temps 
tau45(1) = equilibrium(FO_arr45(1), FA_arr45(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau45(end));
nu_2(end+1) = nu_2(end) + nurate(tau45(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau45(end+1) = equilibrium(FO_arr45(i), FA_arr45(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau45(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau45(end));
    nu_2(end+1) = nu_2(end) + nurate(tau45(end), nu_2(end));
end 


%clear ghg sum and re-initialize 
clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 6.0
%variables to store RCP data
mu_1 = CO260data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH460data(236:end);

%initialize array for equilibrium temps 
tau60(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau60(end));
nu_2(end+1) = nu_2(end) + nurate(tau60(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau60(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau60(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau60(end));
    nu_2(end+1) = nu_2(end) + nurate(tau60(end), nu_2(end));
end 


%clear sums and re-initialize 
clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 8.5
%variables to store RCP data
mu_1 = CO285data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH485data(236:end);

%initialize array for equilibrium temps 
tau85(1) = equilibrium(FO_arr85(1), FA_arr85(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau85(end));
nu_2(end+1) = nu_2(end) + nurate(tau85(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau85(end+1) = equilibrium(FO_arr85(i), FA_arr85(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau85(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau85(end));
    nu_2(end+1) = nu_2(end) + nurate(tau85(end), nu_2(end));
end 
%% bifurcation diagrams w/o permafrost
mu_1 = CO285data(236:end);   %year 2000 values and onwards
nu_1 = CH485data(236:end);

tau26C(1) = equilibrium(FO_arr26(1), FA_arr26(1), mu_1(1), nu_1(1), 0.6, 0.9);

for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    tau26C(end+1) = equilibrium(FO_arr26(i), FA_arr26(i), mu_1(i), nu_1(i), 0.6, tau26C(end));
end 

mu_1 = CO285data(236:end);   %year 2000 values and onwards
nu_1 = CH485data(236:end);

tau45C(1) = equilibrium(FO_arr45(1), FA_arr45(1), mu_1(1), nu_1(1), 0.6, 0.9);

for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    tau45C(end+1) = equilibrium(FO_arr45(i), FA_arr45(i), mu_1(i), nu_1(i), 0.6, tau45C(end));
end 


mu_1 = CO260data(236:end);   %year 2000 values and onwards
nu_1 = CH460data(236:end);

tau60C(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1), nu_1(1), 0.6, 0.9);

for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    tau60C(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i), nu_1(i), 0.6, tau60C(end));
end 

mu_1 = CO285data(236:end);   %year 2000 values and onwards
nu_1 = CH485data(236:end);

tau85C(1) = equilibrium(FO_arr85(1), FA_arr85(1), mu_1(1), nu_1(1), 0.6, 0.9);

for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    tau85C(end+1) = equilibrium(FO_arr85(i), FA_arr85(i), mu_1(i), nu_1(i), 0.6, tau85C(end));
end 

%% 6.0 tests 

murate = @(tau) 10.^6.*(MA./MCO2).*(Q10(R1,tau_ref,tau,2.5).*fCO2)./mass_atm;
nurate = @(tau,nu2) 10.^9.*(MA./MCH4).*(Q10(R1,tau_ref,tau,2.5).*fCH4)./mass_atm - k_CH4.*nu2;

clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 6.0
%variables to store RCP data
mu_1 = CO260data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH460data(236:end);

%initialize array for equilibrium temps 
tau6025(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau6025(end));
nu_2(end+1) = nu_2(end) + nurate(tau6025(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau6025(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau6025(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau6025(end));
    nu_2(end+1) = nu_2(end) + nurate(tau6025(end), nu_2(end));
end 

murate = @(tau) 10.^6.*(MA./MCO2).*(Q10(R1,tau_ref,tau,3.5).*fCO2)./mass_atm;
nurate = @(tau,nu2) 10.^9.*(MA./MCH4).*(Q10(R1,tau_ref,tau,3.5).*fCH4)./mass_atm - k_CH4.*nu2;

clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 6.0
%variables to store RCP data
mu_1 = CO260data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH460data(236:end);

%initialize array for equilibrium temps 
tau6035(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau6035(end));
nu_2(end+1) = nu_2(end) + nurate(tau6035(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau6035(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau6035(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau6035(end));
    nu_2(end+1) = nu_2(end) + nurate(tau6035(end), nu_2(end));
end 

murate = @(tau) 10.^6.*(MA./MCO2).*(Q10(R1,tau_ref,tau,4.5).*fCO2)./mass_atm;
nurate = @(tau,nu2) 10.^9.*(MA./MCH4).*(Q10(R1,tau_ref,tau,4.5).*fCH4)./mass_atm - k_CH4.*nu2;

clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 6.0
%variables to store RCP data
mu_1 = CO260data(236:end)-mu2;   %year 2000 values and onwards
nu_1 = CH460data(236:end);

%initialize array for equilibrium temps 
tau6045(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1)+mu_2(1), nu_1(1)+nu_2(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau6045(end));
nu_2(end+1) = nu_2(end) + nurate(tau6045(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau6045(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i)+mu_2(end), nu_1(i)+nu_2(end), 0.6, tau6045(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau6045(end));
    nu_2(end+1) = nu_2(end) + nurate(tau6045(end), nu_2(end));
end 

murate = @(tau) 10.^6.*(MA./MCO2).*(Q10(R1,tau_ref,tau,0).*fCO2)./mass_atm;
nurate = @(tau,nu2) 10.^9.*(MA./MCH4).*(Q10(R1,tau_ref,tau,0).*fCH4)./mass_atm - k_CH4.*nu2;

clear mu_2;
clear nu_2;
mu_2(1) = mu2;  %mu2 is initial CO2 burden from permafrost in the year 2000
nu_2(1) = nu2;  %nu2 is initial CH4 burden from permafrost in the year 2000

%RCP 6.0
%variables to store RCP data
mu_1 = CO260data(236:end);   %year 2000 values and onwards
nu_1 = CH460data(236:end);

%initialize array for equilibrium temps 
tau60C(1) = equilibrium(FO_arr60(1), FA_arr60(1), mu_1(1), nu_1(1), 0.6, 0.9); %eq temp in the year 2000
mu_2(end+1) = mu_2(end) + murate(tau60C(end));
nu_2(end+1) = nu_2(end) + nurate(tau60C(end), nu_2(end));


for i = 2:length(mu_1)    %iterate over RCP starting in 2000
    %solve for surface temp 
    tau60C(end+1) = equilibrium(FO_arr60(i), FA_arr60(i), mu_1(i), nu_1(i), 0.6, tau60C(end));
    
    %difference equations for permafrost ghgs, Euler method
    mu_2(end+1) = mu_2(end) + murate(tau60C(end));
    nu_2(end+1) = nu_2(end) + nurate(tau60C(end), nu_2(end));
end 

%% Plot
t = linspace(2000, 2000+length(tau85), length(tau85));

%permafrost curves 
plot(t, (tau26 - tau26(1)).*273.15 - 273.15, 'Color', [0 1 0], 'linewidth', 1, 'DisplayName', 'RCP 2.6');
hold on
plot(t, (tau45 - tau45(1)).*273.15 - 273.15, 'Color', [0 1 1], 'linewidth', 1, 'DisplayName', 'RCP 4.5');
plot(t, (tau60 - tau60(1)).*273.15 - 273.15, 'Color', [1 0 0], 'linewidth', 1, 'DisplayName', 'RCP 6.0');
plot(t, (tau85 - tau85(1)).*273.15 - 273.15, 'Color', [0 0 1], 'linewidth', 1, 'DisplayName', 'RCP 8.5');
legend;
plot(t, (tau26C - tau26C(1)).*273.15 - 273.15, 'Color', [0 0 0 0.2], 'linewidth', 1);
plot(t, (tau45C - tau45C(1)).*273.15 - 273.15, 'Color', [0 0 0 0.2], 'linewidth', 1);
plot(t, (tau60C - tau60C(1)).*273.15 - 273.15, 'Color', [0 0 0 0.2], 'linewidth', 1);
plot(t, (tau85C - tau85C(1)).*273.15 - 273.15, 'Color', [0 0 0 0.2], 'linewidth', 1);


xlim([2000, 2300])
xlabel('Year')
ylabel('Surface Temperature [C]')
title('Arctic Climate Simulation')
legend;
%% fUNCTIONs
equilibrium(10, 104, CO260data(2000-1764), CH460data(2000-1764), 0.6, 0.9)

function F = EnergyBalanceModelArctic(tau, F_O, F_A, mu, nu, delta)
% This function is the energy balance model for the Arctic region (70N)

% CONSTANTS
T_R = 273.15;                                   % K                     % reference temperature, equal to 0 Celcius
betaconst = 0.63;                               % nondimensional        % fraction of atmospheric irradiance hitting surface           
sigma = 5.670367*10^-8;                         % W/(m^2K^4)            % Stefan-Boltzmann constant 
omega = 0.01;                                   % nondimensional        % albedo switch function smoothness
Gamma = 6.49*10^-3;                             % K/m                   % standard ICAO lapse rate for the troposphere
gamma = Gamma/T_R;                              % 1/m                   % scaled lapse rate for non-dimensional system
k_C = 0.0694;                                   % m^2/kg                % absorption cross-section per unit mass of atmosphere for carbon dioxide
k_W = 0.05905;                                  % m^2/kg                % absorption cross-section per unit mass of atmosphere for water vapour
k_M = 1.4022;                                   % m^2/kg                % absorption cross-section per unit mass of atmosphere for methane                                   % m^2/kg                % absorption cross-section per unit mass of atmosphere for water vapour
Z_P = 9000;                                     % m                     % troposphere height      
L_v = 2.2558*10^6;                              % m^2/s^2               % latent heat of vapourization for water
R = 8.3144598;                                  % J/(mol K)             % universal gas constant
R_W = 461.4;                                    % m^2/(s^2 K)           % specific gas constant of water vapour
alpha_w = 0.08;                                 % nondimensional        % warm (ocean) albedo
alpha_c = 0.7;                                  % nondimensional        % cold (ice) albedo
Q = 173.2;                                      % W/m^2                 % incoming solar radiation at 70N
q = Q/(sigma*T_R^4);                            % nondimensional        % scaled incoming solar radiation at 70N
c_P = 1004;                                     % J/(K kg)              % specific heat capacity of dry atmopshere at T_R
C_LH = 1.0*10^-3;                               % nondimensional        % latent heat bulk exchange coefficient 
C_SH = 1.0*10^-3;                               % nondimensional        % sensible heat bulk exchange coefficient
U_r = 4;                                        % m/s                   % average horizontal wind speed
z_r = 600;                                      % m                     % average height of planetary boundary layer
P_sat = 611.2;                                  % Pa = kg/(m s^2)       % saturated vapour pressure at T_R
rho_wsat = 4.849*10^-3;                         % kg/m^3                % saturated vapour density at T_R
P_0 = 101325.00;                                % Pa                    % pressure at surface 
M =  0.0289644;                                 % kg/mol                % molecular weight of dry air
G_W1 = L_v/(R_W*T_R);                           % nondimensional        % atmospheric water vapour absorption coefficient 1


% FUNCTIONS
T_S = tau*T_R;                                  % K                     % un-scaled surface temperature for use in SH and LH
% density of atmosphere (kg/m^3) at the top of PBL as a function of surface temperature
rho = P_0.*M./(R.*(T_S-Gamma.*z_r));                        
% vertical sensible heat transport (W/m^2) due to turbulent flux in the PBL
SH = c_P.*rho.*C_SH.*U_r.*(Gamma.*z_r);
% vertical latent heat transport (W/m^2) due to turbulent flux in the PBL
LE = L_v.*C_LH.*U_r./(R_W.*(T_S-Gamma.*z_r)).*P_sat.*(exp(G_W1.*(T_S - T_R)./T_S) - delta.*exp(G_W1.*(T_S - Gamma.*z_r -T_R)./(T_S - Gamma.*z_r)));
% combined vertical turbulent heat transport in the PBL
F_C = LE + SH;

f_A  = F_A./(sigma.*T_R.^4);                    % nondimensional        % scaled horizontal atmospheric heat transport
f_O  = F_O./(sigma.*T_R.^4);                    % nondimensional        % scaled horizontal aoceanic heat transport
f_C = F_C./(sigma.*T_R.^4);                     % nondimensional        % scaled vertical turbulent heat flux heat transport

% albedo switch function (nondimensional)
a = 1./2.*((alpha_w + alpha_c)+(alpha_w-alpha_c).*tanh((tau-1)./omega));    

eta_Cl = 0.3736;                               
G_c = 1.52./(10.^6).*k_C.*1.03.*10.^4;         
eta_C1 = 1 - exp(-G_c.*mu);                           
G_M = 0.554./(10.^9).*k_M.*1.03.*10.^4;
eta_M = 1 - exp(-G_M.*nu);
G_W2 = k_W.*rho_wsat./gamma;                   
wvinteg1 = @(w) 1./w.*exp(G_W1.*(w-1)./w);     
eta_W1 = 1 - exp(-delta.*G_W2.*integral(wvinteg1, tau-(gamma.*Z_P), tau));   
eta = 1 - (1-eta_C1).*(1-eta_W1).*(1-eta_Cl).*(1-eta_M); 

% entire energy balance model
F = (1-a).*q.*(1 - 0.2324 - 0.1212) + f_O - tau.^4 - f_C + betaconst.*(0.2324.*q + f_A + f_C + eta.*tau.^4);
end
function e = equilibrium(F_O, F_A, mu, nu, delta, x0)
options = optimset('Display','off');
[sol, err, flag] = fsolve(@(t) EnergyBalanceModelArctic(t, F_O, F_A, mu, nu, delta), x0, options);
if abs(err)>1e-6
    sol = fsolve(@(t) EnergyBalanceModelArctic(t, F_O, F_A, mu, nu, delta), x0+0.5, options);
end
e = sol;
end 
function r2 = Q10(R1, tau1, tau2, sensitivity)
%nondimensional version
    r2 = R1.*(sensitivity.^(273.15.*(tau2-tau1)./10));
end
function c = concentration(masses, initial_concentrations)
%{
Computes new concentrations for CO2 and CH4 given the mass of each gas 
input to the atmosphere and the previous global concentrations.

Args:  masses - tuple containing added mass of carbon in the form of CO2 
                and CH4 ([mCO2 mCH4])
       initial_concentrations - tuple of concentrations before permafrost
                                respiration, [mu_i nu_i] in units [ppm ppb]

Returns: c - tuple of new global atmospheric concentrations, 
             [mu_f nu_f] in units [ppm ppb]
%}

cco2_i = initial_concentrations(1); %initial concentration CO2 (ppm)
cch4_i = initial_concentrations(2); %initial concentration CH4 (ppb)

MCO2 = 44.01e-3;   %Molar masses of CO2, CH4, C, O, H and atmosphere kg mol^-1
MCH4 = 16.04e-3;
MC = 12.0107e-3;
M = 28.97e-3; 

mco2added = masses(1);
mch4added = masses(2);

cco2 = cco2_i./(10.^6);  %ppm to fraction
cch4 = cch4_i./(10.^9);  %ppb to fraction
rho = 1.2;   %atmospheric density 

%atmosphere volume calculation
radius_troposphere = @(x) 16000.*x./pi + 9000 + 6371.*1000;
volume = 2.*integral2(@(x,y) (1/3).*sin(x).*(radius_troposphere(x).^3 - (6371.*1000).^3), 0, pi./2, 0, 2.*pi);

M_atm = rho.*volume; %total mass of atmosphere
mco2initial = (MCO2./M).*cco2.*M_atm; %initial mass of CO2 in atmosphere using mol to mass ratio
mch4initial = (MCH4./M).*cch4.*M_atm; %initial mass of CH4 in atmosphere

M_atmnew = M_atm + mco2added + mch4added;   %new mass of atmosphere
mco2new = mco2initial + mco2added;  %new mass of CO2 in atmosphere
mch4new = mch4initial + mch4added;  %new mass of CH4 in atmosphere

co2ratio = (M./MCO2).*(mco2new./M_atmnew);  %mass concentration to mol concentration
ch4ratio = (M./MCH4).*(mch4new./M_atmnew);  

c(1) = co2ratio.*10.^6; %fraction to ppm
c(2) = ch4ratio.*10.^9; %fraction to ppb
end